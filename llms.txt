# Flight Analysis - R Package

[![License:
MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

An R package for analyzing, forecasting, and collecting flight data and
prices from Google Flights.

**Credits:** This package is an R implementation inspired by the
original Python package
[google-flight-analysis](https://github.com/celebi-pkg/flight-analysis)
by Kaya Celebi.

## Features

- Detailed scraping and querying tools for Google Flights using chromote
- Support for multiple trip types: one-way, round-trip, chain-trip, and
  perfect-chain
- Driver-free web scraping using Chrome DevTools Protocol
- Flexible date search across multiple airports and date ranges
- Summary tables showing prices by city and date
- Automatic identification of cheapest travel dates

## Installation

You can install the development version of flightanalysis from GitHub:

``` r
install.packages('flightanalysis', repos = c('https://rempsyc.r-universe.dev', 'https://cloud.r-project.org'))

# Or if you need the version from the last hour, install through `remotes`
# install.packages("remotes")
remotes::install_github("rempsyc/flightanalysis")
```

## Usage

### Loading the Package

``` r
library(flightanalysis)
```

### Creating Flight Queries

The main scraping function that makes up the backbone of most
functionalities is
[`fa_define_query()`](https://rempsyc.github.io/flightanalysis/reference/fa_define_query.md).
It serves as a data object, preserving the flight information as well as
meta-data from your query.

``` r
# Round-trip
query <- fa_define_query("JFK", "IST", "2025-07-20", "2025-08-20")
query
```

``` R
## Flight Query( {Not Yet Fetched}
## 2025-07-20: JFK --> IST
## 2025-08-20: IST --> JFK
## )
```

The package supports multiple trip types:

- **One-way**: `fa_define_query("JFK", "IST", "2025-07-20")`
- **Round-trip**:
  `fa_define_query("JFK", "IST", "2025-07-20", "2025-08-20")`
- **Chain-trip**:
  `fa_define_query("JFK", "IST", "2025-08-20", "RDU", "LGA", "2025-12-25")`
- **Perfect-chain**:
  `fa_define_query("JFK", "2025-09-20", "IST", "2025-09-25", "JFK")`

### Scraping Data

The package includes full web scraping functionality using **chromote**:

``` r
# Create a query
query <- fa_define_query("JFK", "IST", "2025-12-18", "2026-01-02")

# Fetch the flight data
flights <- fa_fetch_flights(query)
```

``` R
##   Segment 1/2: JFK -> IST on 2025-12-18
##   [OK] Successfully parsed 7 flights
##   Segment 2/2: IST -> JFK on 2026-01-02
##   [OK] Successfully parsed 9 flights
##   [OK] Total flights retrieved: 16
```

``` r
# View the flight data
head(flights$data) |>
  knitr::kable()
```

| departure_datetime  | arrival_datetime    | origin | destination | airlines                | travel_time  | price | num_stops | layover         | access_date         | co2_emission_kg | emission_diff_pct |
|:--------------------|:--------------------|:-------|:------------|:------------------------|:-------------|------:|----------:|:----------------|:--------------------|----------------:|------------------:|
| 2025-12-18 21:20:00 | 2025-12-19 16:55:00 | JFK    | IST         | KLMDelta                | 11 hr 35 min |  1470 |         1 | 1 hr 5 min AMS  | 2025-11-14 19:44:40 |             444 |                NA |
| 2025-12-18 00:20:00 | 2025-12-18 18:10:00 | JFK    | IST         | Turkish AirlinesJetBlue | 9 hr 50 min  |  1692 |         0 | NA              | 2025-11-14 19:44:40 |             528 |                NA |
| 2025-12-18 12:50:00 | 2025-12-19 06:45:00 | JFK    | IST         | Turkish Airlines        | 9 hr 55 min  |  1692 |         0 | NA              | 2025-11-14 19:44:40 |             414 |                NA |
| 2025-12-18 20:05:00 | 2025-12-19 14:05:00 | JFK    | IST         | Price graph             | 10 hr        |  1722 |         0 | NA              | 2025-11-14 19:44:40 |             528 |                NA |
| 2025-12-18 01:00:00 | 2025-12-19 03:50:00 | JFK    | IST         | Air FranceDelta, KLM    | 18 hr 50 min |  1244 |         1 | 8 hr 15 min CDG | 2025-11-14 19:44:40 |             551 |                 0 |
| 2025-12-18 16:40:00 | 2025-12-19 16:55:00 | JFK    | IST         | Delta, KLM              | 16 hr 15 min |  1470 |         1 | 5 hr 40 min AMS | 2025-11-14 19:44:40 |             450 |                NA |

**Why chromote?**

- ✅ No external driver files needed (uses Chrome DevTools Protocol
  directly)
- ✅ More reliable - no driver version mismatches or port conflicts
- ✅ Works on all platforms (Windows, macOS, Linux)
- ✅ Fully headless by default

## Flexible Date Search

The package supports flexible date search across multiple airports and
dates:

``` r
# Create query objects for multiple origins and dates
queries <- fa_create_date_range(
  origin = c("BOM", "DEL"),
  dest = "JFK",
  date_min = "2025-12-18",
  date_max = "2025-12-22"
)

# Fetch all flights
flights <- fa_fetch_flights(queries)
```

``` R
## Scraping 2 objects...
## 
## [1/2]   Segment 1/5: BOM -> JFK on 2025-12-18
##   [OK] Successfully parsed 12 flights
##   Segment 2/5: BOM -> JFK on 2025-12-19
##   [OK] Successfully parsed 10 flights
##   Segment 3/5: BOM -> JFK on 2025-12-20
##   [OK] Successfully parsed 10 flights
##   Segment 4/5: BOM -> JFK on 2025-12-21
##   [OK] Successfully parsed 8 flights
##   Segment 5/5: BOM -> JFK on 2025-12-22
##   [OK] Successfully parsed 9 flights
##   [OK] Total flights retrieved: 49
## [2/2]   Segment 1/5: DEL -> JFK on 2025-12-18
##   [OK] Successfully parsed 8 flights
##   Segment 2/5: DEL -> JFK on 2025-12-19
##   [OK] Successfully parsed 10 flights
##   Segment 3/5: DEL -> JFK on 2025-12-20
##   [OK] Successfully parsed 9 flights
##   Segment 4/5: DEL -> JFK on 2025-12-21
##   [OK] Successfully parsed 9 flights
##   Segment 5/5: DEL -> JFK on 2025-12-22
##   [OK] Successfully parsed 8 flights
##   [OK] Total flights retrieved: 44
```

``` r
# Create summary table (City × Date with prices)
fa_summarize_prices(flights) |>
  knitr::kable()
```

| City   | Origin | 2025-12-18 | 2025-12-19 | 2025-12-20 | 2025-12-21 | 2025-12-22 | Average_Price |
|:-------|:-------|:-----------|:-----------|:-----------|:-----------|:-----------|:--------------|
| Mumbai | BOM    | \$361      | \$365      | \$478      | \$413      | \$365      | \$396         |
| Delhi  | DEL    | \$361      | \$361      | \$463      | \$463      | \$373      | \$404         |
| Best   | Best   | X          | X          | X          | X          | X          |               |

``` r
# Find the cheapest dates
fa_find_best_dates(
  flights, 
  by = "min",
  price_max = 1400,
  max_stops = 1,
  travel_time_max = 26  # 26 hours (numeric = hours, or use "26 hr" format)
  ) |>
  knitr::kable()
```

| origin | price | num_stops | layover         | travel_time  | co2_emission_kg | airlines                 | n_routes | departure_date | departure_time |
|:-------|------:|----------:|:----------------|:-------------|----------------:|:-------------------------|---------:|:---------------|:---------------|
| BOM    |   365 |         1 | 3 hr 15 min AUH | 21 hr 15 min |             844 | Etihad                   |        1 | 2025-12-19     | 04:40:00       |
| BOM    |   365 |         1 | 3 hr 15 min AUH | 21 hr 15 min |             845 | Etihad                   |        1 | 2025-12-22     | 04:40:00       |
| DEL    |   393 |         1 | 2 hr 45 min AUH | 21 hr 30 min |             871 | Etihad                   |        1 | 2025-12-18     | 04:25:00       |
| DEL    |   393 |         1 | 3 hr 30 min AUH | 22 hr 35 min |             843 | Etihad                   |        1 | 2025-12-19     | 20:55:00       |
| DEL    |   408 |         1 | 2 hr CDG        | 19 hr 45 min |             794 | Air FranceDelta, KLM     |        1 | 2025-12-18     | 01:30:00       |
| BOM    |   413 |         1 | 3 hr 15 min AUH | 21 hr 15 min |             852 | Etihad                   |        1 | 2025-12-18     | 04:40:00       |
| BOM    |   413 |         1 | 2 hr 5 min AUH  | 20 hr 15 min |             763 | Akasa Air, Etihad        |        1 | 2025-12-19     | 23:15:00       |
| BOM    |   413 |         1 | 2 hr 5 min AUH  | 20 hr 15 min |             763 | Akasa Air, Etihad        |        1 | 2025-12-20     | 23:15:00       |
| BOM    |   413 |         1 | 2 hr 5 min AUH  | 20 hr 15 min |             763 | Akasa Air, Etihad        |        1 | 2025-12-22     | 23:15:00       |
| BOM    |   418 |         1 | 3 hr 55 min IST | 21 hr 55 min |             811 | IndiGo, Turkish Airlines |        2 | 2025-12-18     | 06:45:00       |

**Key Features:**

- Search multiple origin airports and dates efficiently
- Create wide summary tables for easy price comparison
- Identify cheapest travel dates automatically
- Direct query object support - no manual data processing needed

## Development Status

This is a complete R port of the Python package. The core data
structures and API are fully implemented. Web scraping functionality
uses chromote (Chrome DevTools Protocol), which provides driver-free
browser automation without the configuration overhead of RSelenium.

## License

MIT License

## Original Python Package

This is a port of the
[google-flight-analysis](https://github.com/celebi-pkg/flight-analysis)
Python package by Kaya Celebi.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

# Package index

## All functions

- [`fa_create_date_range()`](https://rempsyc.github.io/flightanalysis/reference/fa_create_date_range.md)
  : Create Date Range Queries
- [`fa_define_query()`](https://rempsyc.github.io/flightanalysis/reference/fa_define_query.md)
  : Define Flight Query
- [`fa_fetch_flights()`](https://rempsyc.github.io/flightanalysis/reference/fa_fetch_flights.md)
  : Fetch Flight Data
- [`fa_find_best_dates()`](https://rempsyc.github.io/flightanalysis/reference/fa_find_best_dates.md)
  : Find Best Travel Dates
- [`fa_summarize_prices()`](https://rempsyc.github.io/flightanalysis/reference/fa_summarize_prices.md)
  : Create Price Summary Table
- [`print(`*`<flight_query>`*`)`](https://rempsyc.github.io/flightanalysis/reference/print.flight_query.md)
  : Print method for flight query objects
- [`print(`*`<flight_record>`*`)`](https://rempsyc.github.io/flightanalysis/reference/print.flight_record.md)
  : Print method for flight_record objects
- [`sample_flights`](https://rempsyc.github.io/flightanalysis/reference/sample_flights.md)
  : Sample Flight Data
- [`sample_multi_origin`](https://rempsyc.github.io/flightanalysis/reference/sample_multi_origin.md)
  : Sample Multiple Origin Queries
- [`sample_query`](https://rempsyc.github.io/flightanalysis/reference/sample_query.md)
  : Sample Flight Query

